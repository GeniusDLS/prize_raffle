<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∑—ñ–≥—Ä–∞—à –ø—Ä–∏–∑—ñ–≤</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è -->
    <div id="auto-save-indicator" class="auto-save-indicator">üíæ –ê–≤—Ç–æ–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ</div>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
                <h1>–†–æ–∑—ñ–≥—Ä–∞—à –ø—Ä–∏–∑—ñ–≤</h1>
                <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showPage('data')">üìù –î–∞–Ω—ñ</button>
            <button class="nav-tab" onclick="showPage('raffle')">üé≤ –†–æ–∑—ñ–≥—Ä–∞—à</button>
            <button class="nav-tab" onclick="showPage('results')">üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏</button>
        </div>

        <!-- –°—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö -->
        <div id="data-page" class="page active">
            <div class="storage-controls">
                <h4>üíæ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="loadExcelData()">üìä –Ü–º–ø–æ—Ä—Ç –∑ Excel</button>
                    <button class="btn btn-primary" onclick="exportToExcel()">üìã –ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
                    <button class="btn btn-warning" onclick="clearStoredData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ</button>
                    <button class="btn btn-secondary" onclick="showAnimationSettings()">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó</button>
                </div>
                <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    –î–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ —Ç–∞ –≤—ñ–¥–Ω–æ–≤–ª—é—é—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.
                </p>
            </div>

            <div class="form-section">
                <h3>üë• –£—á–∞—Å–Ω–∏–∫–∏</h3>
                <div class="form-group">
                    <input type="text" id="participant-name" placeholder="–Ü–º'—è —É—á–∞—Å–Ω–∏–∫–∞" style="flex: 2">
                    <input type="text" id="participant-division" placeholder="–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª" style="flex: 2">
                    <input type="number" id="participant-weight" placeholder="–í–∞–≥–∞" min="1" value="1" style="flex: 1">
                    <button class="btn btn-primary" onclick="addParticipant()">–î–æ–¥–∞—Ç–∏</button>
                </div>
                <div id="participants-error" class="error-message" style="display: none;"></div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–Ü–º'—è</th>
                            <th>–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</th>
                            <th>–í–∞–≥–∞</th>
                            <th>–î—ñ—ó</th>
                        </tr>
                    </thead>
                    <tbody id="participants-list"></tbody>
                </table>
            </div>

            <div class="form-section">
                <h3>üéÅ –ü—Ä–∏–∑–∏</h3>
                <div class="form-group">
                    <input type="text" id="prize-name" placeholder="–ù–∞–∑–≤–∞ –ø—Ä–∏–∑—É" style="flex: 2">
                    <input type="number" id="prize-count" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å" min="1" value="1" style="flex: 1">
                    <button class="btn btn-primary" onclick="addPrize()">–î–æ–¥–∞—Ç–∏</button>
                </div>
                <div id="prizes-error" class="error-message" style="display: none;"></div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞</th>
                            <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
                            <th>–î—ñ—ó</th>
                        </tr>
                    </thead>
                    <tbody id="prizes-list"></tbody>
                </table>
            </div>

            <input type="file" id="excel-input" accept=".xlsx,.xls" style="display: none;" onchange="handleExcelLoad(event)">
        </div>

        <!-- –°—Ç–æ—Ä—ñ–Ω–∫–∞ —Ä–æ–∑—ñ–≥—Ä–∞—à—É -->
        <div id="raffle-page" class="page">
            <div class="raffle-container">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-participants">0</div>
                        <div>–£—á–∞—Å–Ω–∏–∫—ñ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-prizes">0</div>
                        <div>–ü—Ä–∏–∑—ñ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="current-round">0</div>
                        <div>–†–∞—É–Ω–¥</div>
                    </div>
                </div>

                <div class="drums-container">
                    <div class="drum">
                        <h3>üë§ –£—á–∞—Å–Ω–∏–∫</h3>
                        <div class="drum-window">
                            <div class="drum-content" id="participant-drum">–ì–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–∑—ñ–≥—Ä–∞—à—É!</div>
                        </div>
                    </div>
                    <div class="drum">
                        <h3>üéÅ –ü—Ä–∏–∑</h3>
                        <div class="drum-window">
                            <div class="drum-content" id="prize-drum">–ì–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–∑—ñ–≥—Ä–∞—à—É!</div>
                        </div>
                    </div>
                </div>

                <div class="raffle-controls">
                    <button class="btn btn-primary" id="start-raffle-btn" onclick="startRaffle()">üé≤ –†–æ–∑–ø–æ—á–∞—Ç–∏ —Ä–æ–∑—ñ–≥—Ä–∞—à</button>
                    <button class="btn btn-primary" id="next-round-btn" onclick="nextRound()" style="display: none;">‚û°Ô∏è –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–∞—É–Ω–¥</button>
                    <button class="btn btn-primary" id="new-raffle-btn" onclick="startNewRaffle()" style="display: none;">üÜï –ù–æ–≤–∏–π —Ä–æ–∑—ñ–≥—Ä–∞—à</button>
                    <button class="btn btn-danger" onclick="resetRaffle()">üîÑ –°–∫–∏–Ω—É—Ç–∏ —Ä–æ–∑—ñ–≥—Ä–∞—à</button>
                </div>

                <div id="raffle-message" style="margin-top: 20px; font-size: 1.2em; font-weight: bold;"></div>
            </div>
        </div>

        <!-- –°—Ç–æ—Ä—ñ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ -->
        <div id="results-page" class="page">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="results-total-rounds">0</div>
                    <div>–ó–∞–≥–∞–ª–æ–º —Ä–∞—É–Ω–¥—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="results-winners">0</div>
                    <div>–ü–µ—Ä–µ–º–æ–∂—Ü—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="results-prizes-given">0</div>
                    <div>–ü—Ä–∏–∑—ñ–≤ —Ä–æ–∑–¥–∞–Ω–æ</div>
                </div>
            </div>

            <div class="form-section">
                <h3>üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—ñ–≥—Ä–∞—à—É</h3>
                <div id="results-list" class="results-list">
                    <p style="text-align: center; color: #666;">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑'—è–≤–ª—è—Ç—å—Å—è –ø—ñ—Å–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è —Ä–æ–∑—ñ–≥—Ä–∞—à—É</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" onclick="exportResultsToExcel()">üìä –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤ Excel</button>
                <button class="btn btn-danger" onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏</button>
            </div>
        </div>

        <!-- –°—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∞–Ω—ñ–º–∞—Ü—ñ—ó -->
        <div id="animation-settings-page" class="page">
            <div class="form-section">
                <h3>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó</h3>
                <p style="margin-bottom: 20px; color: #666;">–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ä–æ–∑—ñ–≥—Ä–∞—à—É –ø—ñ–¥ –≤–∞—à—ñ –ø–æ—Ç—Ä–µ–±–∏</p>
                
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="spin-duration">üé≤ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –±–∞—Ä–∞–±–∞–Ω—ñ–≤ (—Å–µ–∫—É–Ω–¥–∏):</label>
                        <input type="number" id="spin-duration" min="0.5" max="10" step="0.5" value="2">
                        <small>–Ø–∫ –¥–æ–≤–≥–æ –±–∞—Ä–∞–±–∞–Ω–∏ –±—É–¥—É—Ç—å –∫—Ä—É—Ç–∏—Ç–∏—Å—è –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—ñ–≥—Ä–∞—à—É</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="spin-speed">‚ö° –®–≤–∏–¥–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ (–º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏):</label>
                        <input type="number" id="spin-speed" min="50" max="500" step="10" value="100">
                        <small>–®–≤–∏–¥–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ —ñ–º–µ–Ω —Ç–∞ –ø—Ä–∏–∑—ñ–≤ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω–∞—Ö</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="spin-rotations">üîÑ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±–µ—Ä—Ç—ñ–≤:</label>
                        <input type="number" id="spin-rotations" min="0.5" max="10" step="0.5" value="3">
                        <small>–°–∫—ñ–ª—å–∫–∏ –ø–æ–≤–Ω–∏—Ö –æ–±–µ—Ä—Ç—ñ–≤ –∑—Ä–æ–±–∏—Ç—å –±–∞—Ä–∞–±–∞–Ω (–º–æ–∂–Ω–∞ –¥—Ä–æ–±–æ–≤—ñ: 0.5, 1.5, —Ç–æ—â–æ)</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="easing-speed">üìâ –®–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è:</label>
                        <input type="number" id="easing-speed" min="0.1" max="1.0" step="0.1" value="0.8">
                        <small>–Ø–∫ —à–≤–∏–¥–∫–æ –∞–Ω—ñ–º–∞—Ü—ñ—è —Å–ø–æ–≤—ñ–ª—å–Ω—é—î—Ç—å—Å—è –¥–æ –∑—É–ø–∏–Ω–∫–∏ (0.1 - –ø–ª–∞–≤–Ω–æ, 1.0 - —Ä—ñ–∑–∫–æ)</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="result-highlight-duration">‚ú® –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (—Å–µ–∫—É–Ω–¥–∏):</label>
                        <input type="number" id="result-highlight-duration" min="1" max="10" step="0.5" value="3">
                        <small>–Ø–∫ –¥–æ–≤–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ –ø—ñ–¥—Å–≤—ñ—á–µ–Ω–∏–π –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="popup-countdown-time">‚è∞ –ß–∞—Å –∞–≤—Ç–æ–∑–∞–∫—Ä–∏—Ç—Ç—è popup (—Å–µ–∫—É–Ω–¥–∏):</label>
                        <input type="number" id="popup-countdown-time" min="5" max="60" step="1" value="10">
                        <small>–ß–µ—Ä–µ–∑ —Å–∫—ñ–ª—å–∫–∏ —Å–µ–∫—É–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–∫—Ä–∏—î—Ç—å—Å—è –≤—ñ–∫–Ω–æ –∑ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è–º</small>
                    </div>
                    
                    <div class="setting-item">
                        <label for="enable-sound">üîä –ó–≤—É–∫–æ–≤—ñ –µ—Ñ–µ–∫—Ç–∏:</label>
                        <input type="checkbox" id="enable-sound">
                        <small>–£–≤—ñ–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫–æ–≤—ñ –µ—Ñ–µ–∫—Ç–∏ –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—ñ–≥—Ä–∞—à—É</small>
                    </div>
                </div>
                
                <div class="settings-actions">
                    <button class="btn btn-primary" onclick="saveAnimationSettings()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
                    <button class="btn btn-warning" onclick="resetAnimationSettings()">üîÑ –°–∫–∏–Ω—É—Ç–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤—ñ</button>
                    <button class="btn btn-secondary" onclick="hideAnimationSettings()">‚¨ÖÔ∏è –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å</button>
                </div>
                
                <div class="settings-info">
                    <h4>üí° –ü–æ—Ä–∞–¥–∏:</h4>
                    <ul>
                        <li>–î–ª—è —à–≤–∏–¥—à–∏—Ö —Ä–æ–∑—ñ–≥—Ä–∞—à—ñ–≤ –∑–º–µ–Ω—à—Ç–µ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –æ–±–µ—Ä—Ç–∞–Ω–Ω—è</li>
                        <li>–ó–±—ñ–ª—å—à—Ç–µ —à–≤–∏–¥–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–∏ –¥–ª—è –±—ñ–ª—å—à –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –µ—Ñ–µ–∫—Ç—É</li>
                        <li>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ –Ω–µ –≤—Ç—Ä–∞—á–∞—é—Ç—å—Å—è –ø—Ä–∏ –æ—á–∏—â–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö</li>
                        <li>–ó–≤—É–∫–æ–≤—ñ –µ—Ñ–µ–∫—Ç–∏ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–µ –≤ —É—Å—ñ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup –∑ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è–º –ø–µ—Ä–µ–º–æ–∂—Ü—è -->
    <div id="winner-popup" class="winner-popup">
        <div class="popup-overlay"></div>
        <div class="popup-content">
            <div class="confetti-container">
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
                <div class="confetti"></div>
            </div>
            <div class="trophy-icon">üèÜ</div>
            <div class="popup-title">üéâ –í–Ü–¢–ê–Ñ–ú–û! üéâ</div>
            <div class="winner-info">
                <div class="winner-name" id="winner-name">–£—á–∞—Å–Ω–∏–∫ 16</div>
                <div class="winner-division" id="winner-division">–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</div>
                <div class="winner-action">–≤–∏–≥—Ä–∞–≤</div>
                <div class="winner-prize" id="winner-prize">–ü—Ä–∏–∑ 10</div>
            </div>
            <div class="congratulations">
                –©–∏—Ä–æ –≤—ñ—Ç–∞—î–º–æ –∑ –ø–µ—Ä–µ–º–æ–≥–æ—é!<br>
                –ë–∞–∂–∞—î–º–æ –≥–∞—Ä–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ—é —Ç–∞ —É—Å–ø—ñ—Ö—ñ–≤!
            </div>
            <div class="celebration-emoji">üéä ‚ú® üéà ‚ú® üéä</div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –î–∞–ª—ñ —Ç–∞ countdown -->
            <div class="popup-actions">
                <button class="btn btn-primary popup-continue-btn" onclick="hideWinnerPopup()">–î–∞–ª—ñ</button>
                <div class="popup-countdown">
                    –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–∫—Ä–∏—î—Ç—å—Å—è —á–µ—Ä–µ–∑: <span id="countdown-timer">10</span> —Å–µ–∫
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫ —Ç–∞ —Å–∫—Ä–∏–ø—Ç—ñ–≤ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>